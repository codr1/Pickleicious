// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: organizations.sql

package db

import (
	"context"
	"database/sql"
	"time"
)

const getOrganizationByID = `-- name: GetOrganizationByID :one
SELECT id, name, slug, email_from_address, status, created_at, updated_at
FROM organizations
WHERE id = ?1
`

type GetOrganizationByIDRow struct {
	ID               int64          `json:"id"`
	Name             string         `json:"name"`
	Slug             string         `json:"slug"`
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
	Status           string         `json:"status"`
	CreatedAt        time.Time      `json:"createdAt"`
	UpdatedAt        time.Time      `json:"updatedAt"`
}

func (q *Queries) GetOrganizationByID(ctx context.Context, id int64) (GetOrganizationByIDRow, error) {
	row := q.queryRow(ctx, q.getOrganizationByIDStmt, getOrganizationByID, id)
	var i GetOrganizationByIDRow
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.EmailFromAddress,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getOrganizationBySlug = `-- name: GetOrganizationBySlug :one

SELECT id, name, slug, email_from_address, status, created_at, updated_at
FROM organizations
WHERE slug = ?1 AND status = 'active'
`

type GetOrganizationBySlugRow struct {
	ID               int64          `json:"id"`
	Name             string         `json:"name"`
	Slug             string         `json:"slug"`
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
	Status           string         `json:"status"`
	CreatedAt        time.Time      `json:"createdAt"`
	UpdatedAt        time.Time      `json:"updatedAt"`
}

// internal/db/queries/organizations.sql
func (q *Queries) GetOrganizationBySlug(ctx context.Context, slug string) (GetOrganizationBySlugRow, error) {
	row := q.queryRow(ctx, q.getOrganizationBySlugStmt, getOrganizationBySlug, slug)
	var i GetOrganizationBySlugRow
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Slug,
		&i.EmailFromAddress,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getOrganizationCrossFacilitySetting = `-- name: GetOrganizationCrossFacilitySetting :one
SELECT cross_facility_visit_packs
FROM organizations
WHERE id = ?1
`

func (q *Queries) GetOrganizationCrossFacilitySetting(ctx context.Context, id int64) (bool, error) {
	row := q.queryRow(ctx, q.getOrganizationCrossFacilitySettingStmt, getOrganizationCrossFacilitySetting, id)
	var cross_facility_visit_packs bool
	err := row.Scan(&cross_facility_visit_packs)
	return cross_facility_visit_packs, err
}

const getOrganizationEmailConfig = `-- name: GetOrganizationEmailConfig :one
SELECT id, email_from_address
FROM organizations
WHERE id = ?1
`

type GetOrganizationEmailConfigRow struct {
	ID               int64          `json:"id"`
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
}

func (q *Queries) GetOrganizationEmailConfig(ctx context.Context, id int64) (GetOrganizationEmailConfigRow, error) {
	row := q.queryRow(ctx, q.getOrganizationEmailConfigStmt, getOrganizationEmailConfig, id)
	var i GetOrganizationEmailConfigRow
	err := row.Scan(&i.ID, &i.EmailFromAddress)
	return i, err
}

const listOrganizations = `-- name: ListOrganizations :many
SELECT id, name, slug, email_from_address, status, created_at, updated_at
FROM organizations
WHERE status = 'active'
ORDER BY name
`

type ListOrganizationsRow struct {
	ID               int64          `json:"id"`
	Name             string         `json:"name"`
	Slug             string         `json:"slug"`
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
	Status           string         `json:"status"`
	CreatedAt        time.Time      `json:"createdAt"`
	UpdatedAt        time.Time      `json:"updatedAt"`
}

func (q *Queries) ListOrganizations(ctx context.Context) ([]ListOrganizationsRow, error) {
	rows, err := q.query(ctx, q.listOrganizationsStmt, listOrganizations)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListOrganizationsRow
	for rows.Next() {
		var i ListOrganizationsRow
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Slug,
			&i.EmailFromAddress,
			&i.Status,
			&i.CreatedAt,
			&i.UpdatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateOrganizationEmailConfig = `-- name: UpdateOrganizationEmailConfig :one
UPDATE organizations
SET email_from_address = ?1,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?2
RETURNING id, email_from_address
`

type UpdateOrganizationEmailConfigParams struct {
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
	ID               int64          `json:"id"`
}

type UpdateOrganizationEmailConfigRow struct {
	ID               int64          `json:"id"`
	EmailFromAddress sql.NullString `json:"emailFromAddress"`
}

func (q *Queries) UpdateOrganizationEmailConfig(ctx context.Context, arg UpdateOrganizationEmailConfigParams) (UpdateOrganizationEmailConfigRow, error) {
	row := q.queryRow(ctx, q.updateOrganizationEmailConfigStmt, updateOrganizationEmailConfig, arg.EmailFromAddress, arg.ID)
	var i UpdateOrganizationEmailConfigRow
	err := row.Scan(&i.ID, &i.EmailFromAddress)
	return i, err
}
