// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: users.sql

package db

import (
	"context"
	"database/sql"
)

const createStaffUser = `-- name: CreateStaffUser :execlastid
INSERT INTO users (
    first_name, last_name, email, phone,
    home_facility_id, local_auth_enabled,
    is_staff, staff_role, status
) VALUES (
    ?1, ?2, ?3, ?4,
    ?5, ?6,
    1, ?7, ?8
)
`

type CreateStaffUserParams struct {
	FirstName        string         `json:"firstName"`
	LastName         string         `json:"lastName"`
	Email            sql.NullString `json:"email"`
	Phone            sql.NullString `json:"phone"`
	HomeFacilityID   sql.NullInt64  `json:"homeFacilityId"`
	LocalAuthEnabled bool           `json:"localAuthEnabled"`
	StaffRole        sql.NullString `json:"staffRole"`
	Status           string         `json:"status"`
}

func (q *Queries) CreateStaffUser(ctx context.Context, arg CreateStaffUserParams) (int64, error) {
	result, err := q.exec(ctx, q.createStaffUserStmt, createStaffUser,
		arg.FirstName,
		arg.LastName,
		arg.Email,
		arg.Phone,
		arg.HomeFacilityID,
		arg.LocalAuthEnabled,
		arg.StaffRole,
		arg.Status,
	)
	if err != nil {
		return 0, err
	}
	return result.LastInsertId()
}

const getUserByEmail = `-- name: GetUserByEmail :one

SELECT id, email, phone, cognito_sub, cognito_status, preferred_auth_method, password_hash, local_auth_enabled, first_name, last_name, photo_url, street_address, city, state, postal_code, home_facility_id, is_member, is_staff, date_of_birth, waiver_signed, membership_level, staff_role, status, created_at, updated_at FROM users WHERE email = ?1 LIMIT 1
`

// internal/db/queries/users.sql
func (q *Queries) GetUserByEmail(ctx context.Context, email sql.NullString) (User, error) {
	row := q.queryRow(ctx, q.getUserByEmailStmt, getUserByEmail, email)
	var i User
	err := row.Scan(
		&i.ID,
		&i.Email,
		&i.Phone,
		&i.CognitoSub,
		&i.CognitoStatus,
		&i.PreferredAuthMethod,
		&i.PasswordHash,
		&i.LocalAuthEnabled,
		&i.FirstName,
		&i.LastName,
		&i.PhotoUrl,
		&i.StreetAddress,
		&i.City,
		&i.State,
		&i.PostalCode,
		&i.HomeFacilityID,
		&i.IsMember,
		&i.IsStaff,
		&i.DateOfBirth,
		&i.WaiverSigned,
		&i.MembershipLevel,
		&i.StaffRole,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getUserByID = `-- name: GetUserByID :one
SELECT id, email, phone, cognito_sub, cognito_status, preferred_auth_method, password_hash, local_auth_enabled, first_name, last_name, photo_url, street_address, city, state, postal_code, home_facility_id, is_member, is_staff, date_of_birth, waiver_signed, membership_level, staff_role, status, created_at, updated_at FROM users WHERE id = ?1 LIMIT 1
`

func (q *Queries) GetUserByID(ctx context.Context, id int64) (User, error) {
	row := q.queryRow(ctx, q.getUserByIDStmt, getUserByID, id)
	var i User
	err := row.Scan(
		&i.ID,
		&i.Email,
		&i.Phone,
		&i.CognitoSub,
		&i.CognitoStatus,
		&i.PreferredAuthMethod,
		&i.PasswordHash,
		&i.LocalAuthEnabled,
		&i.FirstName,
		&i.LastName,
		&i.PhotoUrl,
		&i.StreetAddress,
		&i.City,
		&i.State,
		&i.PostalCode,
		&i.HomeFacilityID,
		&i.IsMember,
		&i.IsStaff,
		&i.DateOfBirth,
		&i.WaiverSigned,
		&i.MembershipLevel,
		&i.StaffRole,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getUserByPhone = `-- name: GetUserByPhone :one
SELECT id, email, phone, cognito_sub, cognito_status, preferred_auth_method, password_hash, local_auth_enabled, first_name, last_name, photo_url, street_address, city, state, postal_code, home_facility_id, is_member, is_staff, date_of_birth, waiver_signed, membership_level, staff_role, status, created_at, updated_at FROM users WHERE phone = ?1 LIMIT 1
`

func (q *Queries) GetUserByPhone(ctx context.Context, phone sql.NullString) (User, error) {
	row := q.queryRow(ctx, q.getUserByPhoneStmt, getUserByPhone, phone)
	var i User
	err := row.Scan(
		&i.ID,
		&i.Email,
		&i.Phone,
		&i.CognitoSub,
		&i.CognitoStatus,
		&i.PreferredAuthMethod,
		&i.PasswordHash,
		&i.LocalAuthEnabled,
		&i.FirstName,
		&i.LastName,
		&i.PhotoUrl,
		&i.StreetAddress,
		&i.City,
		&i.State,
		&i.PostalCode,
		&i.HomeFacilityID,
		&i.IsMember,
		&i.IsStaff,
		&i.DateOfBirth,
		&i.WaiverSigned,
		&i.MembershipLevel,
		&i.StaffRole,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateStaffUser = `-- name: UpdateStaffUser :exec
UPDATE users
SET first_name = ?1,
    last_name = ?2,
    email = ?3,
    phone = ?4,
    home_facility_id = ?5,
    local_auth_enabled = ?6,
    staff_role = ?7,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?8 AND is_staff = 1
`

type UpdateStaffUserParams struct {
	FirstName        string         `json:"firstName"`
	LastName         string         `json:"lastName"`
	Email            sql.NullString `json:"email"`
	Phone            sql.NullString `json:"phone"`
	HomeFacilityID   sql.NullInt64  `json:"homeFacilityId"`
	LocalAuthEnabled bool           `json:"localAuthEnabled"`
	StaffRole        sql.NullString `json:"staffRole"`
	ID               int64          `json:"id"`
}

func (q *Queries) UpdateStaffUser(ctx context.Context, arg UpdateStaffUserParams) error {
	_, err := q.exec(ctx, q.updateStaffUserStmt, updateStaffUser,
		arg.FirstName,
		arg.LastName,
		arg.Email,
		arg.Phone,
		arg.HomeFacilityID,
		arg.LocalAuthEnabled,
		arg.StaffRole,
		arg.ID,
	)
	return err
}

const updateUserCognitoStatus = `-- name: UpdateUserCognitoStatus :exec
UPDATE users
SET cognito_status = ?1,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?2
`

type UpdateUserCognitoStatusParams struct {
	CognitoStatus sql.NullString `json:"cognitoStatus"`
	ID            int64          `json:"id"`
}

func (q *Queries) UpdateUserCognitoStatus(ctx context.Context, arg UpdateUserCognitoStatusParams) error {
	_, err := q.exec(ctx, q.updateUserCognitoStatusStmt, updateUserCognitoStatus, arg.CognitoStatus, arg.ID)
	return err
}

const updateUserPasswordHash = `-- name: UpdateUserPasswordHash :exec
UPDATE users
SET password_hash = ?1,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?2
`

type UpdateUserPasswordHashParams struct {
	PasswordHash sql.NullString `json:"passwordHash"`
	ID           int64          `json:"id"`
}

func (q *Queries) UpdateUserPasswordHash(ctx context.Context, arg UpdateUserPasswordHashParams) error {
	_, err := q.exec(ctx, q.updateUserPasswordHashStmt, updateUserPasswordHash, arg.PasswordHash, arg.ID)
	return err
}

const updateUserStatus = `-- name: UpdateUserStatus :exec
UPDATE users
SET status = ?1,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?2
`

type UpdateUserStatusParams struct {
	Status string `json:"status"`
	ID     int64  `json:"id"`
}

func (q *Queries) UpdateUserStatus(ctx context.Context, arg UpdateUserStatusParams) error {
	_, err := q.exec(ctx, q.updateUserStatusStmt, updateUserStatus, arg.Status, arg.ID)
	return err
}
